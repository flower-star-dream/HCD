# hcd-common
spring:
  main:
    web-application-type: reactive
  cloud:
    gateway:
      discovery:
        locator:
          enabled: false
          lower-case-service-id: true
      routes:
        - id: hcd-docs
          uri: lb://hcd-user
          predicates:
            - Path=/v3/api-docs/**
          filters: []
        - id: hcd-user
          uri: lb://hcd-user
          predicates:
            - Path=/api/v1/*/user/**
        - id: hcd-trainSeat
          uri: lb://hcd-trainSeat
          predicates:
            - Path=/api/v1/*/trainSeat/**
        - id: hcd-ticket
          uri: lb://hcd-ticket
          predicates:
            - Path=/api/v1/*/ticket/**
        - id: hcd-order
          uri: lb://hcd-order
          predicates:
            - Path=/api/v1/*/order/**
        - id: hcd-system
          uri: lb://hcd-system
          predicates:
            - Path=/api/v1/*/system/**
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 40
      minimum-idle: 20
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  data:
    redis:
      host: localhost
      port: 6379
      password: 123456
      database: 0
      timeout: 5000ms
      lettuce:
        pool:
          max-active: 40
          max-idle: 40
          min-idle: 20
          max-wait: -1ms
  minio:
    endpoint: http://localhost:9000
    access-key: s3cr3t
    secret-key: a3cr3t
    bucket-name: hcd
  rabbitmq:
    host: localhost
    port: 5672
    username: admin
    password: admin
    virtual-host: hcd
    listener:
      simple:
        retry:
          max-attempts: 3
          initial-interval: 1000ms
  elasticsearch:
    uris: http://localhost:9200
    username: elastic
    password: changeme

# SpringDoc OpenAPI 配置
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html

# Knife4j 配置
knife4j:
  enable: true
  setting:
    language: zh_cn

# Actuator管理端点配置
management:
  endpoints:
    web:
      exposure:
        include: mappings
  endpoint:
    health:
      show-details: always
  health:
    rabbit:
      enabled: false


# mybatis-plus:
#   #mapper配置文件
#   mapper-locations: classpath:mapper/*.xml
#   type-aliases-package: top.flowerstardream.hcd.**.bo.eo
#   configuration:
#     #开启驼峰命名
#     map-underscore-to-camel-case: true
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  type-aliases-package: top.flowerstardream.hcd.**.bo.eo
  configuration:
    map-underscore-to-camel-case: true


# 日志配置
logging:
  level:
    top.flower.star.dream.hcd: debug
    org.springframework.web: debug
    com.alibaba.cloud.nacos: debug
    org.springframework.cloud.gateway: DEBUG
    org.springframework.http.server.reactive: DEBUG
    org.springdoc: DEBUG
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
    file: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'

hcd:
  jwt:
    # 设置jwt签名加密时使用的秘钥
    admin-secret-key: 48E61cUFc5I2SdUSisWz4D0iQHIxDf07tFxZXWrdPTbAn8zcEtD6YkHV3t1xbQUm
    # 设置jwt过期时间
    admin-ttl: 7200000
    # 设置前端传递过来的令牌名称
    admin-token-name: token
    # 设置最小刷新间隔(S)
    admin-refresh-time: 300
    # 设置jwt签名加密时使用的秘钥
    user-secret-key: 48E61cUFc5I2SdUSisWz4D0iQHIxDf07tFxZXWrdPTbAn8zcEtD6YkHV3t1xbQUm
    # 设置jwt过期时间
    user-ttl: 7200000
    # 设置前端传递过来的令牌名称
    user-token-name: authentication
    # 设置最小刷新间隔(S)
    user-refresh-time: 300
  thread-pool:
    business:
      core-pool-size: 10
      max-pool-size: 50
      queue-capacity: 200
      keep-alive-seconds: 60
      thread-name-prefix: "business-"
      rejected-execution-handler: "CallerRunsPolicy"
      wait-for-tasks-to-complete-on-shutdown: true
      await-termination-seconds: 60
    common:
      core-pool-size: 5
      max-pool-size: 20
      queue-capacity: 100
      keep-alive-seconds: 30
      thread-name-prefix: "common-"
      rejected-execution-handler: "DiscardPolicy"
      wait-for-tasks-to-complete-on-shutdown: true
      await-termination-seconds: 30
    message:
      core-pool-size: 8
      max-pool-size: 30
      queue-capacity: 500
      keep-alive-seconds: 30
      thread-name-prefix: "message-"
      rejected-execution-handler: "DiscardOldestPolicy"
      wait-for-tasks-to-complete-on-shutdown: true
      await-termination-seconds: 30
    id-generator:
      twepoch: 1672531200000
      worker-id: 0
      worker-id-bits: 10
      sequence-bits: 12

#hcd-user:
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/hcd_user?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=GMT%2B8
    username: root
    password: 1234

# 日志配置
logging:
  file:
    name: logs/hcd_user.log